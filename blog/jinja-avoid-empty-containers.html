

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Small Wins: Avoid empty containers in Jinja &mdash; Frontend Developer Handbook  documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/zon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Switching text colors in subject to its background color lightness" href="switching-text-colors-by-lightness.html" />
    <link rel="prev" title="ZEIT ONLINE Developer Blog" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          
<a href="../index.html">
<img src="../_static/zon.png" class="logo" alt="Logo"/>
 Frontend Developer Handbook
</a>


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          

            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Blog</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html#contents">Contents</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Blog: Avoiding empty containers in jinja</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#the-problem-empty-containers">The problem: empty containers</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-bad-solution-too-many-conditions">The bad solution: too many conditions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-good-solution-set-blocks">The good solution: set blocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="#resources">Resources</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="switching-text-colors-by-lightness.html">Blog: Switching text color by lightness</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../links/index.html">Links</a></li>
<li class="toctree-l1"><a class="reference internal" href="../javascript/guidelines.html">Javascript Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sass/guidelines.html">Sass Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../practices/index.html">Practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../experiments/index.html">Experiments</a></li>
</ul>

            
          


<ul style="margin-top: 2em">
  <li class="toctree-l1"><a class="reference external" href="https://github.com/ZeitOnline/frontend-developer-handbook/edit/master/blog/jinja-avoid-empty-containers.md" target="_blank">Diese Seite editieren</a></li>
</ul>


        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Frontend Developer Handbook</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">ZEIT ONLINE Developer Blog</a> &raquo;</li>
        
      <li>Small Wins: Avoid empty containers in Jinja</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/blog/jinja-avoid-empty-containers.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">

           <div itemprop="articleBody">
            
  <div class="section" id="small-wins-avoid-empty-containers-in-jinja">
<h1>Small Wins: Avoid empty containers in Jinja<a class="headerlink" href="#small-wins-avoid-empty-containers-in-jinja" title="Permalink to this headline">¶</a></h1>
<p>At ZEIT ONLINE, our teasers and articles are composed of many parts like subtemplates and macros. Each component might be hidden under certain conditions. If all content of a wrapper element is hidden, we want to avoid rendering empty containers. A lesser-known Jinja feature helps us with that.</p>
<div class="section" id="the-problem-empty-containers">
<h2>The problem: empty containers<a class="headerlink" href="#the-problem-empty-containers" title="Permalink to this headline">¶</a></h2>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="x">&lt;div class=&quot;metadata&quot;&gt;</span>
<span class="x">  </span><span class="cp">{%</span> <span class="k">include</span> <span class="s1">&#39;byline.html&#39;</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">  </span><span class="cp">{{</span> <span class="nv">macro.include_datetime</span><span class="o">(</span><span class="nv">teaser</span><span class="o">)</span> <span class="cp">}}</span><span class="x"></span>
<span class="x">  </span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">comments</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">    &lt;a href=&quot;</span><span class="cp">{{</span> <span class="nv">teaser</span> <span class="o">|</span> <span class="nf">create_url</span> <span class="cp">}}</span><span class="x">#comments&quot;&gt;</span><span class="cp">{{</span> <span class="nv">comments</span> <span class="cp">}}</span><span class="x"> Comments&lt;/a&gt;</span>
<span class="x">  </span><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">&lt;/div&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="the-bad-solution-too-many-conditions">
<h2>The bad solution: too many conditions<a class="headerlink" href="#the-bad-solution-too-many-conditions" title="Permalink to this headline">¶</a></h2>
<p>We could define variables which check the individual parts for their content, and respond to that.</p>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">set</span> <span class="nv">teaser_has_author</span> <span class="o">=</span> <span class="nv">teaser</span> <span class="o">|</span> <span class="nf">get_authors</span> <span class="o">|</span> <span class="nf">length</span> <span class="cp">%}</span><span class="x"></span>
<span class="cp">{%</span> <span class="k">set</span> <span class="nv">teaser_has_special_format</span> <span class="o">=</span> <span class="o">(</span><span class="nv">teaser.format</span> <span class="o">==</span> <span class="s1">&#39;essay&#39;</span> <span class="k">or</span> <span class="nv">teaser.format</span> <span class="o">==</span> <span class="s1">&#39;interview&#39;</span> <span class="cp">%}</span><span class="x"></span>
<span class="cp">{%</span> <span class="k">set</span> <span class="nv">byline_has_content</span> <span class="o">=</span> <span class="nv">teaser_has_author</span> <span class="k">and</span> <span class="nv">teaser_has_special_format</span> <span class="cp">%}</span><span class="x"></span>

<span class="cp">{%</span> <span class="k">set</span> <span class="nv">macro_has_content</span> <span class="o">=</span> <span class="nv">macro.include_datetime</span><span class="o">(</span><span class="nv">teaser</span><span class="o">)</span> <span class="o">|</span> <span class="nf">length</span> <span class="cp">%}</span><span class="x"></span>

<span class="cp">{%</span> <span class="k">if</span> <span class="nv">byline_has_content</span> <span class="k">and</span> <span class="nv">macro_has_content</span> <span class="k">and</span> <span class="nv">comments</span> -<span class="cp">%}</span><span class="x"></span>

<span class="x">  &lt;div class=&quot;metadata&quot;&gt;</span>
<span class="x">    </span><span class="cp">{%</span> <span class="k">include</span> <span class="s1">&#39;byline.html&#39;</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">    </span><span class="cp">{{</span> <span class="nv">macro.include_datetime</span><span class="o">(</span><span class="nv">teaser</span><span class="o">)</span> <span class="cp">}}</span><span class="x"></span>
<span class="x">    </span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">comments</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">      &lt;a href=&quot;</span><span class="cp">{{</span> <span class="nv">teaser</span> <span class="o">|</span> <span class="nf">create_url</span> <span class="cp">}}</span><span class="x">#comments&quot;&gt;</span><span class="cp">{{</span> <span class="nv">comments</span> <span class="cp">}}</span><span class="x"> Comments&lt;/a&gt;</span>
<span class="x">    </span><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">  &lt;/div&gt;</span>

<span class="cp">{%</span>- <span class="k">endif</span> <span class="cp">%}</span><span class="x"></span>
</pre></div>
</div>
<p>But this is not elegant, and sometimes even tricky because the outer template does not (and should not) know the inner workings of included subtemplates. Especially if many outer templates include the same part.</p>
<p>We can do better:</p>
</div>
<div class="section" id="the-good-solution-set-blocks">
<h2>The good solution: set blocks<a class="headerlink" href="#the-good-solution-set-blocks" title="Permalink to this headline">¶</a></h2>
<p>Jinja2 introduced a new feature in version 2.8: set blocks. We know the old traditional way of defining a variable via set <code class="docutils literal notranslate"><span class="pre">{%</span> <span class="pre">set</span> <span class="pre">foo</span> <span class="pre">=</span> <span class="pre">'bar'</span> <span class="pre">%}</span></code> and of defining a block this way: <code class="docutils literal notranslate"><span class="pre">{%</span> <span class="pre">block</span> <span class="pre">foo</span> <span class="pre">%}bar{%</span> <span class="pre">block</span> <span class="pre">%}</span></code>. Even though version 2.8 was released in 2016, I have not been aware of the possibility to define (set) variables in the block style.</p>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span>- <span class="k">set</span> <span class="nv">teaser_metadata</span> <span class="o">|</span> <span class="nf">trim</span> -<span class="cp">%}</span><span class="x"></span>
<span class="x">  </span><span class="cp">{%</span> <span class="k">include</span> <span class="s1">&#39;byline.html&#39;</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">  </span><span class="cp">{{</span> <span class="nv">macro.include_datetime</span><span class="o">(</span><span class="nv">teaser</span><span class="o">)</span> <span class="cp">}}</span><span class="x"></span>
<span class="x">  </span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">comments</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">    &lt;a href=&quot;</span><span class="cp">{{</span> <span class="nv">teaser</span> <span class="o">|</span> <span class="nf">create_url</span> <span class="cp">}}</span><span class="x">#comments&quot;&gt;</span><span class="cp">{{</span> <span class="nv">comments</span> <span class="cp">}}</span><span class="x"> Comments&lt;/a&gt;</span>
<span class="x">  </span><span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span><span class="x"></span>
<span class="cp">{%</span>- <span class="k">endset</span> <span class="cp">%}</span><span class="x"></span>

<span class="cp">{%</span> <span class="k">if</span> <span class="nv">teaser_metadata</span> <span class="o">|</span> <span class="nf">length</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">  &lt;div class=&quot;metadata&quot;&gt;</span>
<span class="x">    </span><span class="cp">{{</span> <span class="nv">teaser_metadata</span> <span class="cp">}}</span><span class="x"></span>
<span class="x">  &lt;/div&gt;</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span><span class="x"></span>
</pre></div>
</div>
<p>This way, the wrapper div only gets printed if it actually has content. Each part of this content is responsible for their own output. Included subtemplates (<code class="docutils literal notranslate"><span class="pre">{%</span> <span class="pre">include</span> <span class="pre">'byline.html'</span> <span class="pre">%}</span></code>) and macros (<code class="docutils literal notranslate"><span class="pre">{{</span> <span class="pre">macro.include_datetime(teaser)</span> <span class="pre">}}</span></code>) do also avoid rendering empty blocks – and might use Jinjas <code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">block</span></code> method for that.</p>
<p>You can do the same check for blocks as well, but I prefer the cleaner way of having variables.</p>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">block</span> <span class="nv">teaser_metadata</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">...</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span><span class="x"></span>

<span class="cp">{%</span> <span class="k">if</span> <span class="nv">self.teaser_metadata</span><span class="o">()</span> <span class="o">|</span> <span class="nf">trim</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">  &lt;div class=&quot;metadata&quot;&gt;</span>
<span class="x">    </span><span class="cp">{{</span> <span class="nv">self.teaser_metadata</span><span class="o">()</span> <span class="cp">}}</span><span class="x"></span>
<span class="x">  &lt;/div&gt;</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span><span class="x"></span>
</pre></div>
</div>
</div>
<div class="section" id="resources">
<h2>Resources<a class="headerlink" href="#resources" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="http://jinja.pocoo.org/docs/2.10/templates/#block-assignments">Block Assignments in Jinja2</a></p></li>
</ul>
<hr class="docutils" />
<p><em>Written 2019-03-07 by Thomas Puppe</em></p>
</div>
</div>


           </div>
           
          </div>

<iframe src="" style="width:100px;height:75px;border:none;"></iframe>

          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="switching-text-colors-by-lightness.html" class="btn btn-neutral float-right" title="Switching text colors in subject to its background color lightness" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral float-left" title="ZEIT ONLINE Developer Blog" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright ZEIT ONLINE
      <span class="lastupdated">
        Last updated on Nov 30, 2020.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>